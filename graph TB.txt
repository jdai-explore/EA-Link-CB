graph TB
    %% ==== PRESENTATION LAYER ====
    subgraph PRES["üñ•Ô∏è PRESENTATION LAYER"]
        UI["`**Desktop Application**
        üí¨ Chat Interface
        üöÄ Project Setup Wizard
        üëÄ Document Preview
        üì§ Export Manager`"]
    end
    
    %% ==== INPUT SOURCES LAYER ====
    subgraph INPUT["üì• INPUT SOURCES LAYER"]
        direction TB
        subgraph DATA_IN["Data Sources"]
            QMS["`**QMS Documents**
            üìÑ HTML, Word, Excel
            üìä PDF, Visio Files
            üîÑ Workflows & Diagrams
            üíæ <10GB total`"]
        end
        
        subgraph CONTEXT_IN["Context & Feedback"]
            direction LR
            CONTEXT["`**Project Context**
            üéØ Project Type
            üë• Team Roles
            üõ†Ô∏è Client Tools
            ‚úÖ Compliance Req.`"]
            
            FEEDBACK["`**User Feedback**
            ‚≠ê Process Ratings
            ‚úèÔ∏è Manual Edits
            üìà Usage Patterns
            üéØ Success Metrics`"]
        end
    end
    
    %% ==== DATA PROCESSING LAYER ====
    subgraph PROCESS["‚öôÔ∏è DATA PROCESSING LAYER"]
        direction LR
        PARSE["`**Document Parser**
        üìù Multi-format Support
        üîç Content Extraction
        üìä Metadata Enrichment`"]
        
        CHUNK["`**Content Processor**
        ‚úÇÔ∏è Semantic Chunking
        üè∑Ô∏è Classification
        üßÆ Embedding Generation`"]
    end
    
    %% ==== KNOWLEDGE STORAGE LAYER ====
    subgraph STORAGE_LAYER["üíæ KNOWLEDGE STORAGE LAYER"]
        direction LR
        VECTOR["`**Vector Database**
        üîç Embeddings
        üîé Similarity Search
        üìä Semantic Index`"]
        
        GRAPH["`**Graph Database**
        üîó Process Relations
        üë• Role Mappings
        üõ†Ô∏è Tool Dependencies`"]
        
        DOCS["`**Document Store**
        üìÅ Raw Documents
        üìã Templates Library
        üìà Version Control`"]
    end
    
    %% ==== INTELLIGENCE LAYER ====
    subgraph INTEL["üß† INTELLIGENCE LAYER"]
        direction TB
        
        subgraph MEMORY_SYS["Memory System"]
            MEMORY["`**Memory Engine**
            üß† Short-term Context
            üìö Long-term Learning
            üë§ User Preferences
            üéØ Pattern Recognition`"]
        end
        
        subgraph PROCESSING_ENG["Processing Engines"]
            direction LR
            RAG["`**RAG Engine**
            üîç Semantic Retrieval
            üìä Context Ranking
            üîÑ Hybrid Search
            üß† Memory Integration`"]
            
            CONTEXT_ENG["`**Context Engine**
            ‚öôÔ∏è Process Customization
            üîÑ Role Mapping
            üõ†Ô∏è Tool Adaptation
            üìã Profile Management`"]
        end
    end
    
    %% ==== CORE AI LAYER ====
    subgraph CORE["ü§ñ CORE AI PROCESSING LAYER"]
        LLM["`**LLM Engine**
        ü§ñ DeepSeek/LLAMA API
        üí≠ Advanced Prompt Engineering
        üéØ Context Window Management
        ‚ú® Intelligent Response Generation
        üß† Memory-Informed Processing
        üîÑ Adaptive Learning Integration`"]
    end
    
    %% ==== OUTPUT GENERATION LAYER ====
    subgraph GEN["üìù OUTPUT GENERATION LAYER"]
        direction TB
        
        subgraph GENERATION["Content Generation"]
            GENERATOR["`**Document Generator**
            üìÑ Multi-format Output
            üìã Template Engine
            üîÑ Workflow Visualizer
            üìä Quality Validation`"]
        end
        
        subgraph LEARNING["Continuous Learning"]
            IMPROVE["`**Learning Engine**
            üìä Feedback Analysis
            üìà Usage Analytics
            üéØ Success Tracking
            üîÑ Model Refinement`"]
        end
    end
    
    %% ==== OUTPUT DELIVERY LAYER ====
    subgraph OUT["üì§ OUTPUT DELIVERY LAYER"]
        direction LR
        OFFICE["`**Microsoft Suite**
        üìÑ Word Documents
        üìä Excel Spreadsheets
        üìã PowerPoint Slides
        üîÑ Visio Diagrams`"]
        
        ASSETS["`**Process Assets**
        üìù Custom Guidelines
        üìã Smart Checklists
        üîÑ Workflow Templates
        üìä PM Templates`"]
    end
    
    %% ========== PRIMARY DATA FLOW ==========
    %% User Interface Flow
    UI --> CONTEXT
    UI --> FEEDBACK
    
    %% Data Ingestion Flow
    QMS --> PARSE
    PARSE --> CHUNK
    
    %% Storage Flow
    CHUNK --> VECTOR
    CHUNK --> GRAPH
    CHUNK --> DOCS
    
    %% Intelligence Processing Flow
    VECTOR --> RAG
    GRAPH --> RAG
    DOCS --> RAG
    VECTOR --> MEMORY
    
    %% Context Integration
    CONTEXT --> CONTEXT_ENG
    CONTEXT_ENG --> RAG
    
    %% Core Processing Flow
    RAG --> LLM
    MEMORY --> LLM
    CONTEXT_ENG --> LLM
    
    %% Generation Flow
    LLM --> GENERATOR
    
    %% Output Flow
    GENERATOR --> OFFICE
    GENERATOR --> ASSETS
    
    %% Delivery to User
    OFFICE --> UI
    ASSETS --> UI
    
    %% ========== LEARNING & FEEDBACK LOOPS ==========
    FEEDBACK --> IMPROVE
    IMPROVE -.->|Learning Updates| MEMORY
    IMPROVE -.->|Model Tuning| LLM
    IMPROVE -.->|Template Refinement| GENERATOR
    IMPROVE -.->|Process Optimization| RAG
    
    %% ========== STYLING ==========
    classDef layerHeader fill:#f0f0f0,stroke:#333,stroke-width:2px,color:#333,font-weight:bold
    classDef userLayer fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    classDef inputLayer fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000
    classDef processLayer fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000
    classDef storageLayer fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    classDef intelLayer fill:#fff8e1,stroke:#fbc02d,stroke-width:2px,color:#000
    classDef coreLayer fill:#ffebee,stroke:#d32f2f,stroke-width:3px,color:#000
    classDef genLayer fill:#e0f2f1,stroke:#00796b,stroke-width:2px,color:#000
    classDef outputLayer fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    classDef subgroupStyle fill:#f9f9f9,stroke:#666,stroke-width:1px,color:#000
    
    %% Apply styles to components
    class UI userLayer
    class QMS,CONTEXT,FEEDBACK inputLayer
    class PARSE,CHUNK processLayer
    class VECTOR,GRAPH,DOCS storageLayer
    class MEMORY,RAG,CONTEXT_ENG intelLayer
    class LLM coreLayer
    class GENERATOR,IMPROVE genLayer
    class OFFICE,ASSETS outputLayer